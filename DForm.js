function dForm_Create(a,b,c){const d=document.querySelector(b);let e=Array.from(d.querySelector("form").childNodes).slice(0,-2).filter(a=>"DIV"===a.tagName);e.forEach(a=>{a.innerHTML="",count=0}),Object.keys(a).forEach(b=>{let{e_type:e,row_Schema:f,e_name:g,group_con:h}=a[b];const i=d.querySelector(`.${h}`);dRow_ContainerCreate(i,b,a[b]);const j=document.querySelector(`#${b}`);if("dynamicAccordion"===e){let a=c?.[h]?c[h]:null;accordionCreate(i,j,a,f,{e_name:g,e_type:e})}else if("staticAccordion"===e){let a=c?.[h]?c[h]:null;accordionCreate(i,j,a,f,{e_name:g,e_type:e})}else handleDynamicRows(j,a,b,c)})}function accordionCreate(a,b,c,d,e){if(!("dynamicAccordion"===e.e_type)){let a=createAccordion(b,`${b.id}-${count}`,`${e.e_name}`,null);Object.keys(d).forEach(b=>{dRow_ContainerCreate(a,b,d[b]);const e=a.querySelector(`#${b}`);handleDynamicRows(e,d,b,c?c:null)})}else if(c)a.innerHTML="",c.forEach((f,g)=>{count++;let h={buttonText:1==g+1?"+":"-",buttonFun:1==g+1?"_addAccordion(event)":"_deleteAccordion(event)"},i=1==g+1?b.id:`${b.id}_${count}`,j=b.cloneNode(!0);j.id=i,a.appendChild(j);let k=createAccordion(j,`${b.id}-${count}`,`${e.e_name}-${count}`,h);Object.keys(d).forEach(a=>{dRow_ContainerCreate(k,a,d[a]);const b=k.querySelector(`#${a}`);handleDynamicRows(b,d,a,c[g])})});else{count++;let a=createAccordion(b,`${b.id}-${count}`,`${e.e_name}`,{buttonText:"+",buttonFun:"_addAccordion(event)"});Object.keys(d).forEach(b=>{dRow_ContainerCreate(a,b,d[b]);const c=a.querySelector(`#${b}`);handleDynamicRows(c,d,b,null)})}}function handleDynamicRows(a,b,c,d){if("dynamicRow"===b[c].e_type){if(d){let e=d[b[c].e_name];e.forEach((d,e)=>{const f={buttonText:"1"==e+1?"+":"-",buttonFun:"1"==e+1?"_addRow(event)":"_deleteRow(event)"};dRow_Create(a,b[c].row_Schema,f)}),dFormSelectedValue(a,e)}else dRow_Create(a,b[c].row_Schema,{buttonText:"+",buttonFun:"_addRow(event)"});}else if(dRow_Create(a,b[c].row_Schema,null),d){let e={};b[c].row_Schema.forEach(a=>{e[a.f_name]=d[a.f_name]}),dFormSelectedValue(a,[e])}}function dFormSelectedValue(a,b){let c=a.querySelectorAll(".row");c.forEach((a,c)=>{let d=b[c];a.childNodes.forEach(a=>{let b=a.querySelector("input, select");if(b)if(Array.isArray(d[b.name])){b.value=JSON.stringify(d[b.name]);let c=a.querySelector("div"),e=new Event("click");c.dispatchEvent(e)}else if(d[b.name])if(b.hasAttribute("onclick")){let a=new Event("click");b.value=d[b.name],b.dispatchEvent(a)}else{b.value=d[b.name];let a=new Event("change");b.dispatchEvent(a)}})})}function dFormGroupStaticData(a,b){let c=Object.keys(a),d={};return c.forEach(c=>{let e=a[c].rowType;if("Static"===e){let e=a[c].row_Schema,f={};e.forEach(a=>f[a.f_name]=b[a.f_name]),d[c]=f}}),d}function createFormJson(a,b,c,d){checkConType(a,b),Object.keys(a).forEach(d=>{let{group_con:e,e_type:f,e_name:g}=a[d];if("staticAccordion"===f){let f=c.querySelector(`.${e}`);b[e]={};let g=Array.from(f.childNodes)[0],h=g.childNodes[0].querySelector(".accordion-body");checkConType(a[d].row_Schema,b[e],h)}if("dynamicAccordion"===f){let f=c.querySelector(`.${e}`),g=Array.from(f.childNodes);b[e]=[],g.forEach(c=>{let f=c.querySelector(".row"),g={};b[e].push(g);let h=f.childNodes[0].querySelector(".accordion-body");checkConType(a[d].row_Schema,g,h)})}}),console.log(JSON.stringify(b)),d.value=JSON.stringify(b)}
function dCreateMultiSelect(a,b){let c=document.createElement("div");a.f_display||c.classList.add("d-none");let d=document.createElement("input");d.classList.add("d-none"),d.name=a.f_name,d.value=JSON.stringify([]),c.classList.add(a.f_display_name,`col-lg-${a.f_width}`);let e=document.createElement("label");e.classList.add("form-label","fw-bold"),e.textContent=a.f_display_name;let f=document.createElement("div");f.classList.add("list","form-select","ik-txt3"),f.style.cssText="position: relative; height: 28px; padding: 0px",f.setAttribute("onclick",a.a_onChange);let g=document.createElement("p");g.classList.add("ml-2","mt-1"),g.textContent="-------";let h=document.createElement("div");h.classList.add("d-none","items"),h.style.cssText="position: absolute; top: -25px; height: 18vh; overflow: scroll; background-color: white; box-shadow : 0px 4px 12px rgba(0, 0, 0, 0.2); border : 1px solid rgba(0, 0, 0, 0.3); width:18vw;",f.appendChild(g),f.appendChild(d),f.appendChild(h),c.appendChild(e),c.appendChild(f),b.appendChild(c),0!=a.v_options.length&&dCreateMultiSelectOption(h,a.v_options)}function dCreateMultiSelectOption(a,b){a.innerHTML="";let c=document.createDocumentFragment(),d=document.createElement("div");d.classList.add("d-flex","justify-between"),d.style.cssText="border-bottom : 1px solid rgba(0, 0, 0, 0.3);",c.appendChild(d);let e=document.createElement("button");e.type="button",e.classList.add("btn"),e.style.cssText="padding: 2px; width: 126px; font-weight: bold;",e.setAttribute("onclick","selectAllOptions(event)"),e.textContent=`SelectAll`;let f=document.createElement("button");f.type="button",f.classList.add("btn"),f.style.cssText="padding: 2px; width: 126px; font-weight: bold;",f.setAttribute("onclick","clearAllOptions(event)"),f.textContent=`ClearAll`;let g=document.createElement("button");g.type="button",g.classList.add("btn"),g.style.cssText="padding: 2px; width: 126px; font-weight: bold;",g.setAttribute("onclick","closeDropDown(event)"),g.textContent=`Close`,d.appendChild(e),d.appendChild(f),d.appendChild(g),b.forEach(a=>{let b=document.createElement("button");b.classList.add("selectable","col-md-12","btn","text-dark","text-start","py-0"),b.value=`${a}`,b.type="button",b.setAttribute("onclick","selectMultipleOption(this)");let d=document.createElement("span");d.innerText=`${a}`;let e=document.createElement("i");e.classList.add("text-dark"),d.appendChild(e),b.appendChild(d),c.appendChild(b)}),a.appendChild(c)}function dToggleMultiOption(a,b){a.classList.toggle("selected");const c=a.querySelector("span"),d=a.querySelector("span i");d.classList.toggle("bi-check"),d.classList.toggle("text-dark"),a.classList.contains("selected")?(a.style.backgroundColor="#e8e8e8",dAddMultiSelectOption(a.value,b)):(a.style.backgroundColor="",dRemoveMultiSelectOption(a.value,b))}function dAddMultiSelectOption(a,b){let c=b.querySelector("p"),d=b.querySelector("input"),e=JSON.parse(d.value||"[]");e.includes(a)||e.push(a);const f=JSON.stringify(e);d.value=f,d.setAttribute("value",f),c.textContent=2>=e.length?e.join(", "):`${e.length} Selected`}function dRemoveMultiSelectOption(a,b){let c=b.querySelector("p"),d=b.querySelector("input"),e=JSON.parse(d.value),f=e.indexOf(a);e.splice(f,1);const g=JSON.stringify(e);d.value=g,d.setAttribute("value",g),c.textContent=2>=e.length?e.join(", "):`${e.length} Selected`,0>=e.length&&(c.textContent="--------")}function dAddMultipleOptions(a,b){let c=a.querySelector("div");const d=c.querySelectorAll("button");d.forEach(c=>{const d=c.querySelector("span i");b.includes(c.value)&&(d.classList.add("bi-check"),d.classList.add("text-dark"),c.classList.add("selected"),c.style.backgroundColor="#e8e8e8",dAddMultiSelectOption(c.value,a))})}function dClearAll(a,b){let c=b.querySelector("div"),d=new Event("click");a.forEach(a=>dRemoveMultiSelectOption(a,b));const e=c.querySelectorAll("button");e.forEach(a=>{if(a.classList.contains("selected")){a.classList.remove("selected"),a.style.backgroundColor="";const b=a.querySelector("span"),c=a.querySelector("span i");c.classList.toggle("bi-check"),c.classList.toggle("text-dark")}})}function createDynamicOptions(a,b){let c=a.currentTarget.querySelector("div"),d=c.parentNode.querySelector("input");c.classList.toggle("d-none"),dCreateMultiSelectOption(c,b);let e=c.parentNode.querySelector("input").value;const f=c.querySelectorAll("button");f.forEach(a=>{const b=a.querySelector("span i");JSON.parse(e).includes(a.value)&&(b.classList.add("bi-check"),b.classList.add("text-dark"),a.classList.add("selected"),a.style.backgroundColor="#e8e8e8")})}window.dCreateMultiSelect=dCreateMultiSelect,window.dCreateMultiSelectOption=dCreateMultiSelectOption,window.dToggleMultiOption=dToggleMultiOption,window.dAddMultiSelectOption=dAddMultiSelectOption,window.dRemoveMultiSelectOption=dRemoveMultiSelectOption,window.dAddMultipleOptions=dAddMultipleOptions,window.dClearAll=dClearAll,window.createDynamicOptions=createDynamicOptions;
function dRow_ContainerCreate(a,b,c){let d=document.createElement("div");return d.id=b,d.classList.add("mt-2",c.e_name),d.style.display=c.e_display?"block":"none",a.appendChild(d),d}function dRow_Create(a,b,c){let d=document.createElement("div");d.classList.add("row","mt-2"),a.appendChild(d);let e=["text","email","number","password","date","time","date_range","phone"];if(b.forEach(a=>{e.includes(a.f_type)?createInputFields(a,d):"single_select"===a.f_type?createSingleSelectFields(a,d):"data_list"===a.f_type?createDataList(a,d):"multi_select"===a.f_type&&dCreateMultiSelect(a,d)}),c){a.style.border="0.5px dotted black",a.style.padding="10px",a.style.borderRadius="5px";let b=document.createElement("div");b.textContent=c.buttonText,b.classList.add("addButton","col-lg-2","mt-4"),b.style.cssText="cursor : pointer",b.setAttribute("onclick",c.buttonFun),b.style.setProperty("display","block","important"),d.appendChild(b)}}function dRowAdd(a,b){let c,d,e=a.target.parentNode.parentNode;if("accordion-body"===e.parentNode.classList[0]){let f=a.target.parentNode.closest(".accordion").parentNode.parentNode.id,g=f.includes("_")?f.split("_")[0]:f;c=b[g].row_Schema[e.id].row_Schema,d={buttonText:"-",buttonFun:"_deleteRow(event)"}}else c=b[e.id].row_Schema,d={buttonText:"-",buttonFun:"_deleteRow(event)"};let f=e.id,g=dRow_ValidateSchema(c);dRow_Create(e,c,d)}function dRow_Delete_Accordion(a){let b=a.parentNode;b.removeChild(a)}function dRow_SetValues(a,b){a.innerHTML="";let c=document.createElement("option"),d=document.createDocumentFragment();c.textContent="-------",c.value="",c.selected=!0,c.disabled=!0,d.appendChild(c),b&&0!=b.length&&(b.forEach(a=>{let b=document.createElement("option");b.textContent=a,b.value=a,d.appendChild(b)}),a.appendChild(d))}function dRow_ValidateSchema(a){let b=["text","email","number","password","date","time","date_range","phone","multi_select","single_select"],c=new Set,d=!0;return a.forEach(a=>{c.has(a.f_display_name)?(console.error("Display Name Should be Unique"),d=!1):c.add(a.f_display_name),b.includes(a.f_type)||(console.error("Type field Invalid ! "),d=!1),a.f_display_name&&a.f_type&&a.f_name||(console.error(`Missing required property in field: ${JSON.stringify(a)}`),d=!1),"boolean"!=typeof a.f_required&&(console.error(`Invalid value for 'f_required'. It should be a boolean: ${a.f_display_name}`),d=!1),"multi_select"!==a.f_type&&"single_select"!==a.f_type||Array.isArray(a.v_options)||(console.error(`Options are missing or invalid for field: ${a.f_display_name}`),d=!1)}),d}function createInputFields(a,b){let c=document.createElement("div");c.classList.add(a.f_display_name,`col-lg-${a.f_width}`),a.f_display||c.classList.add("d-none"),"always"===a.f_display&&c.style.setProperty("display","block","important");let d=document.createElement("label");d.classList.add("form-label","fw-bold"),d.textContent=a.f_display_name;let e=document.createElement("input");e.classList.add("form-control","ik-txt3","py-1"),e.name=a.f_name,e.type=a.f_type,e.value=a.v_default,e.setAttribute("onclick",a.a_onChange),c.appendChild(d),c.appendChild(e),a.f_placeholder&&(e.placeholder=a.f_placeholder),a.v_min!==void 0&&(e.min=a.v_min),a.v_max!==void 0&&(e.max=a.v_max),a.v_min_len!==void 0&&"number"!==e.type&&(e.minLength=a.v_min_len),a.v_max_len!==void 0&&"number"!==e.type&&(e.maxLength=a.v_max_len),a.f_required&&(e.required=!0),b.appendChild(c)}function createSingleSelectFields(a,b){let c=document.createElement("div");a.f_display||c.classList.add("d-none"),"always"===a.f_display&&c.style.setProperty("display","block","important");let d=document.createElement("label");d.classList.add("form-label","fw-bold"),d.textContent=a.f_display_name;let e=document.createElement("select");e.name=a.f_name,e.classList.add("form-select","ik-txt3","py-1"),a.a_onChange&&e.setAttribute("onchange",a.a_onChange),e.required=a.f_required,c.classList.add(a.f_display_name,`col-lg-${a.f_width}`),c.appendChild(d),c.appendChild(e),b.appendChild(c),dRow_SetValues(e,a.v_options),e.value=a.v_default}function createDataList(a,b){let c=document.createElement("div");c.classList.add(a.f_display_name,`col-lg-${a.f_width}`),a.f_display||c.classList.add("d-none"),"always"===a.f_display&&c.style.setProperty("display","block","important"),b.appendChild(c);let d=document.createElement("label");d.classList.add("form-label","fw-bold"),d.textContent=a.f_display_name,c.appendChild(d);const e=document.createElement("input");e.setAttribute("list","items"),e.setAttribute("id","myInput"),e.setAttribute("name",a.f_name),e.classList.add("form-select","ik-txt3","py-1"),c.appendChild(e);const f=document.createElement("datalist");f.setAttribute("id","items"),c.appendChild(f),dRow_SetValues(f,a.v_options)}function createAccordion(a,b,c,d){let e=document.createElement("div");e.classList.add("row"),a.appendChild(e);let f=document.createElement("div");f.classList.add("accordion","col-lg-12"),e.appendChild(f);let g=document.createElement("div");g.classList.add("accordion-item","w-100"),f.appendChild(g);let h=document.createElement("button");h.classList.add("accordion-button","collapsed","ik-h2","py-1","shadow-none","text-dark","fw-bold"),h.type="button",h.id=`${b}-header`,h.setAttribute("data-bs-toggle","collapse"),h.setAttribute("data-bs-target",`#${b}`),h.setAttribute("aria-expanded","false"),h.setAttribute("aria-controls",b),h.innerHTML=`${c}`,g.appendChild(h);let i=document.createElement("div");i.id=b,i.classList.add("accordion-collapse","collapse","mt-3"),i.setAttribute("aria-labelledby",h.id),i.setAttribute("data-bs-parent",`#${a.id}`),g.appendChild(i);let j=document.createElement("div");if(j.classList.add("accordion-body","pt-0"),i.appendChild(j),d){f.classList.remove("col-lg-12"),f.classList.add("col-lg-11");let a=document.createElement("div");a.textContent=d.buttonText,a.classList.add("addButton","col-lg-1"),a.style.cssText="cursor : pointer",a.setAttribute("onclick",d.buttonFun),e.appendChild(a)}return j}function _accordionAdd(a,b,c){let d=a.target.parentNode.parentNode.id,{e_type:e,e_display:f,e_name:g,row_Schema:h,group_con:i}=b[d];const j=a.target.parentNode.parentNode.parentNode;let k=`${d.split("_")[0]}_${c}`,l=dRow_ContainerCreate(j,k,b[d]),m=createAccordion(l,`ac-${c}`,`${g}-${c}`,{buttonText:"-",buttonFun:"_deleteAccordion(event)"});Object.keys(h).forEach(a=>{let b=dRow_ContainerCreate(m,a,h[a]);handleDynamicRows(b,h,a,null)})}function mappRows(a){let b,c,d=a.target.parentNode.parentNode.parentNode,e=d.closest(".row").parentNode,f=a.target.parentNode.querySelector("label").textContent,g=schema[e.id].row_Schema[d.id].row_Schema,h=g.find(a=>a.f_display_name===f);h.b_rows.forEach(f=>{let g=schema[e.id].row_Schema[f].row_Schema;d.id===f?(b=d,c=a.target.parentNode.parentNode.childNodes):(b=document.querySelector(`#${f}`),c=b.querySelector(".row").childNodes),b.style.display="block";let h=g.filter(b=>b.b_name.includes(a.target.value)).map(a=>a.f_display_name);Array.from(c).forEach(a=>{const b=h.some(b=>a.classList.contains(b));b?a.classList.remove("d-none"):a.classList.add("d-none")})})}async function getResponse(a,b,c,d=null,e=null){let f=new FormData;if(d)for(let a in d)d.hasOwnProperty(a)&&f.append(a,d[a]);const g={method:a,...("GET"!==a&&{headers:{...(e&&{"X-CSRFToken":e})},...(d&&{body:f})})};try{const a=await fetch(b,g);if(!a.ok)return console.error("Invalid response:",a.status,a.statusText),null;let d=await a.json();c.response=d}catch(a){return console.error("Fetch error:",a),null}}function checkConType(a,b,c=null){Object.keys(a).forEach(d=>{let{e_type:e,e_name:f}=a[d];if("dynamicRow"===e){let a=c?c.querySelector(`#${d}`):document.querySelector(`#${d}`);createDynamicRowJson(b,a,f)}if("staticRow"===e){let a=c?c.querySelector(`#${d}`):document.querySelector(`#${d}`);createStaticValueObj(a,b)}})}function createStaticValueObj(a,b){let c=a.querySelector(".row"),d=c.querySelectorAll("div");d.forEach(a=>{let c=a.classList.contains("d-none");if(!c){let c=a.querySelector("input, select");c&&(b[c.name]=c.value)}})}function createDynamicRowJson(a,b,c){let d=b.querySelectorAll(".row"),e=[];d.forEach(a=>{let b={},c=a.querySelectorAll("div");c.forEach(a=>{let c=a.classList.contains("d-none");if(!c){let c=a.querySelector("input, select");c&&(b[c.name]=c.value)}}),e.push(b)}),a[c]=e}(function(a,b){const c=b();if("undefined"!=typeof window)for(const a in c)window[a]=c[a];"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=c:a.MyLibrary=c})("undefined"==typeof window?global:window,function(){return{dRow_ContainerCreate,dRow_Create,dRowAdd,dRow_Delete_Accordion,dRow_ValidateSchema,createInputFields,createSingleSelectFields,createDataList,createAccordion,_accordionAdd,mappRows,getResponse,checkConType,createStaticValueObj,createDynamicRowJson}});
